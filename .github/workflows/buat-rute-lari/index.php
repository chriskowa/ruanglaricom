<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- This site is optimized with the Yoast SEO Premium plugin v25.9 (Yoast SEO v26.4) - https://yoast.com/wordpress/plugins/seo/ -->
  <title>RUNNING ROUTE CREATOR‚Äã - Ruang Lari</title>
  <meta name="description" content="Buat dan bagikan rute lari favoritmu dengan RUNNING ROUTE CREATOR. Mudah dipakai, interaktif, dan cocok untuk komunitas pelari." class="yoast-seo-meta-tag" />
  <link rel="canonical" href="https://ruanglari.com/buat-rute-lari/" class="yoast-seo-meta-tag" />
  <meta property="og:locale" content="id_ID" class="yoast-seo-meta-tag" />
  <meta property="og:type" content="article" class="yoast-seo-meta-tag" />
  <meta property="og:title" content="RUNNING ROUTE CREATOR‚Äã" class="yoast-seo-meta-tag" />
  <meta property="og:description" content="Buat dan bagikan rute lari favoritmu dengan RUNNING ROUTE CREATOR. Mudah dipakai, interaktif, dan cocok untuk komunitas pelari." class="yoast-seo-meta-tag" />
  <meta property="og:url" content="https://ruanglari.com/buat-rute-lari/" class="yoast-seo-meta-tag" />
  <meta property="og:site_name" content="Ruang Lari" class="yoast-seo-meta-tag" />
  <meta property="article:modified_time" content="2025-11-26T10:53:49+00:00" class="yoast-seo-meta-tag" />
  <meta name="twitter:card" content="summary_large_image" class="yoast-seo-meta-tag" />
  <script type="application/ld+json" class="yoast-schema-graph">
    {
      "@context": "https://schema.org",
      "@graph": [{
        "@type": "WebPage",
        "@id": "https://ruanglari.com/buat-rute-lari/",
        "url": "https://ruanglari.com/buat-rute-lari/",
        "name": "RUNNING ROUTE CREATOR‚Äã - Ruang Lari",
        "isPartOf": {
          "@id": "https://ruanglari.com/#website"
        },
        "primaryImageOfPage": {
          "@id": "https://ruanglari.com/buat-rute-lari/#primaryimage"
        },
        "image": {
          "@id": "https://ruanglari.com/buat-rute-lari/#primaryimage"
        },
        "thumbnailUrl": "https://res.cloudinary.com/dslfarxct/images/f_auto,q_auto/v1764150167/route-marked-on-a-map/route-marked-on-a-map.avif?_i=AA",
        "datePublished": "2025-11-26T09:38:46+00:00",
        "dateModified": "2025-11-26T10:53:49+00:00",
        "description": "Buat dan bagikan rute lari favoritmu dengan RUNNING ROUTE CREATOR. Mudah dipakai, interaktif, dan cocok untuk komunitas pelari.",
        "breadcrumb": {
          "@id": "https://ruanglari.com/buat-rute-lari/#breadcrumb"
        },
        "inLanguage": "id",
        "potentialAction": [{
          "@type": "ReadAction",
          "target": ["https://ruanglari.com/buat-rute-lari/"]
        }]
      }, {
        "@type": "ImageObject",
        "inLanguage": "id",
        "@id": "https://ruanglari.com/buat-rute-lari/#primaryimage",
        "url": "https://res.cloudinary.com/dslfarxct/images/f_auto,q_auto/v1764150167/route-marked-on-a-map/route-marked-on-a-map.avif?_i=AA",
        "contentUrl": "https://res.cloudinary.com/dslfarxct/images/f_auto,q_auto/v1764150167/route-marked-on-a-map/route-marked-on-a-map.avif?_i=AA",
        "width": 1680,
        "height": 840,
        "caption": "running route maker"
      }, {
        "@type": "BreadcrumbList",
        "@id": "https://ruanglari.com/buat-rute-lari/#breadcrumb",
        "itemListElement": [{
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://ruanglari.com/"
        }, {
          "@type": "ListItem",
          "position": 2,
          "name": "RUNNING ROUTE CREATOR‚Äã"
        }]
      }, {
        "@type": "WebSite",
        "@id": "https://ruanglari.com/#website",
        "url": "https://ruanglari.com/",
        "name": "Ruang Lari",
        "description": "Stay Informed, Stay Ahead",
        "publisher": {
          "@id": "https://ruanglari.com/#organization"
        },
        "potentialAction": [{
          "@type": "SearchAction",
          "target": {
            "@type": "EntryPoint",
            "urlTemplate": "https://ruanglari.com/?s={search_term_string}"
          },
          "query-input": {
            "@type": "PropertyValueSpecification",
            "valueRequired": true,
            "valueName": "search_term_string"
          }
        }],
        "inLanguage": "id"
      }, {
        "@type": "Organization",
        "@id": "https://ruanglari.com/#organization",
        "name": "Ruang Lari",
        "url": "https://ruanglari.com/",
        "logo": {
          "@type": "ImageObject",
          "inLanguage": "id",
          "@id": "https://ruanglari.com/#/schema/logo/image/",
          "url": "https://res.cloudinary.com/dslfarxct/images/f_auto,q_auto/v1760833773/ruanglari/ruanglari.png?_i=AA",
          "contentUrl": "https://res.cloudinary.com/dslfarxct/images/f_auto,q_auto/v1760833773/ruanglari/ruanglari.png?_i=AA",
          "width": 1772,
          "height": 391,
          "caption": "Ruang Lari"
        },
        "image": {
          "@id": "https://ruanglari.com/#/schema/logo/image/"
        }
      }]
    }
  </script>
  <!-- / Yoast SEO Premium plugin. -->
  <title>Ruang Lari</title>
  <!-- Import Poppins font -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,400;0,600;0,900;1,900&display=swap" rel="stylesheet" />
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background-color: #FFFEFA;
      color: #111;
    }

    .leaflet-control-attribution.leaflet-control {
      display: none !important;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    /* --- Topbar --- */
    .topbar {
      background-color: #cef100;
      color: #222;
      font-size: 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 20px;
    }

    .topbar-left,
    .topbar-right {
      display: flex;
      align-items: center;
    }

    .topbar-left div,
    .topbar-right a {
      display: flex;
      align-items: center;
      margin-right: 16px;
      font-weight: 400;
    }

    .topbar-left div svg,
    .topbar-right a svg {
      width: 18px;
      height: 18px;
      margin-right: 6px;
      fill: #222;
    }

    /* --- Header --- */
    header {
      background-color: #111;
      position: relative;
    }

    .header-container {
      max-width: 1160px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 40px;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo img {
      height: 40px;
    }

    .logo-text {
      font-weight: 900;
      font-size: 20px;
      color: #cef100;
      letter-spacing: 1px;
    }

    nav {
      display: flex;
    }

    nav ul {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      align-items: center;
      font-weight: 400;
    }

    nav ul li {
      position: relative;
      margin-left: 24px;
      cursor: pointer;
      font-size: 14px;
      color: white;
      list-style: none;
      padding: 8px 0;
    }

    nav ul li a {
      color: white;
      text-decoration: none;
      display: inline-block;
    }

    nav ul li a:hover,
    nav ul li a:focus,
    nav ul li a:visited {
      color: white;
      text-decoration: none;
    }

    nav ul li .uael-menu-item,
    nav ul li .uael-sub-menu-item {
      color: white;
      text-decoration: none;
    }

    nav ul li .uael-menu-item:hover,
    nav ul li .uael-menu-item:focus,
    nav ul li .uael-menu-item:visited,
    nav ul li .uael-sub-menu-item:hover,
    nav ul li .uael-sub-menu-item:focus,
    nav ul li .uael-sub-menu-item:visited {
      color: white;
      text-decoration: none;
    }

    nav ul li .uael-has-submenu-container {
      display: inline-block;
    }

    nav ul li.dropdown::after {
      content: " ‚ñº";
      font-size: 10px;
      color: white;
      margin-left: 4px;
    }

    nav ul li .uael-menu-toggle {
      display: none;
    }

    nav ul li .uael-menu-item {
      white-space: nowrap;
    }

    nav ul li .uael-sub-menu-item {
      white-space: nowrap;
    }

    nav ul li {
      position: relative;
    }

    nav ul li>ul {
      display: none;
      position: absolute;
      background: #111;
      top: 100%;
      left: 0;
      list-style: none;
      padding: 8px 0;
      margin: 0;
      margin-top: 0;
      padding-top: 12px;
      min-width: 150px;
      border-radius: 4px;
      z-index: 99;
    }

    nav ul li:hover>ul {
      display: block;
    }

    /* Bridge untuk mencegah dropdown hilang saat mouse bergerak ke child */
    nav ul li>ul::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 12px;
      background: transparent;
    }

    nav ul li>ul li {
      padding: 8px 18px;
      color: #ccc;
      white-space: nowrap;
      font-weight: 400;
      position: relative;
    }

    nav ul li>ul li:first-child {
      padding-top: 12px;
    }

    nav ul li>ul li a {
      color: #ccc;
      text-decoration: none;
    }

    nav ul li>ul li a:hover,
    nav ul li>ul li a:focus,
    nav ul li>ul li a:visited {
      color: #111;
      text-decoration: none;
    }

    nav ul li>ul li:hover {
      background-color: #cef100;
      color: #111;
    }

    nav ul li>ul li:hover a {
      color: #111;
    }

    /* Hamburger menu button - mobile */
    .menu-btn {
      display: none;
      cursor: pointer;
      flex-direction: column;
      gap: 4px;
      z-index: 1001;
      position: relative;
    }

    .menu-btn div {
      width: 25px;
      height: 3px;
      background-color: #cef100;
      transition: all 0.3s ease;
    }

    .menu-btn.active div:nth-child(1) {
      transform: rotate(45deg) translate(5px, 5px);
    }

    .menu-btn.active div:nth-child(2) {
      opacity: 0;
    }

    .menu-btn.active div:nth-child(3) {
      transform: rotate(-45deg) translate(7px, -6px);
    }

    /* --- Main Content --- */
    main {
      padding: 0;
      font-weight: 900;
      font-style: italic;
      font-size: 20px;
      color: #111;
    }

    /* --- Footer --- */
    .footer-main {
      background-color: #111;
      color: #cef100;
      text-align: center;
      padding: 40px 20px 50px;
    }

    .footer-logo {
      display: flex;
      justify-content: center;
      gap: 12px;
      align-items: center;
      margin-bottom: 24px;
    }

    .footer-logo img {
      height: 40px;
    }

    .footer-logo-text {
      font-weight: 900;
      font-size: 20px;
      color: #cef100;
      letter-spacing: 1px;
    }

    .footer-nav {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 24px;
      margin-bottom: 24px;
      font-weight: 400;
    }

    .footer-nav li {
      position: relative;
      list-style: none;
      cursor: pointer;
      color: white;
      font-size: 14px;
    }

    .footer-nav li a {
      position: relative;
      list-style: none;
      cursor: pointer;
      color: white;
      font-size: 14px;
    }

    .footer-nav li.dropdown::after {
      content: " ‚ñº";
      font-size: 10px;
    }

    .footer-nav li>ul {
      display: none;
      position: absolute;
      background: #111;
      top: 25px;
      left: 0;
      padding: 8px 0;
      min-width: 150px;
      border-radius: 4px;
      z-index: 99;
    }

    .footer-nav li:hover>ul {
      display: block;
    }

    .footer-nav li>ul li {
      padding: 6px 18px;
      color: #ccc;
      white-space: nowrap;
    }

    .footer-nav li>ul li:hover {
      background-color: #cef100;
      color: #111;
    }

    .footer-contact {
      display: flex;
      justify-content: center;
      gap: 40px;
      font-size: 14px;
    }

    .footer-contact div {
      display: flex;
      align-items: center;
      gap: 6px;
      color: #cef100;
    }

    .footer-contact svg {
      width: 18px;
      height: 18px;
      fill: #cef100;
    }

    /* --- Bottom bar --- */
    .bottom-bar {
      background-color: #cef100;
      color: #222;
      font-size: 13px;
      display: flex;
      justify-content: space-between;
      padding: 12px 40px;
      font-weight: 400;
    }

    /* --- Responsive --- */
    @media (max-width: 1024px) {
      main {
        padding: 0;
        font-size: 18px;
      }

      .header-container {
        padding: 10px 20px;
      }

      .footer-main {
        padding: 30px 15px 40px;
      }

      .bottom-bar {
        padding: 12px 20px;
        font-size: 12px;
      }
    }

    @media (max-width: 768px) {
      .header-container {
        padding: 10px 20px;
      }

      /* Hide desktop nav, show hamburger */
      nav {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100vh;
        background-color: #111;
        flex-direction: column;
        overflow-y: auto;
        transform: translateX(-100%);
        transition: transform 0.3s ease;
        z-index: 1000;
        padding: 80px 0 20px;
      }

      nav.open {
        transform: translateX(0);
      }

      nav ul {
        flex-direction: column;
        gap: 0;
      }

      nav ul li {
        margin-left: 0;
        border-top: 1px solid #222;
        padding: 15px 30px;
        font-size: 18px;
        color: #cef100;
      }

      nav ul li a {
        color: #cef100;
        text-decoration: none;
      }

      nav ul li a:hover,
      nav ul li a:focus,
      nav ul li a:visited {
        color: #cef100;
        text-decoration: none;
      }

      nav ul li>ul {
        position: static;
        background: transparent;
        padding-left: 20px;
        display: none;
        border-radius: 0;
        margin-top: 8px;
        min-width: auto;
      }

      nav ul li.expanded>ul {
        display: block;
      }

      nav ul li>ul li {
        padding: 8px 0px;
        color: #ddd;
        font-size: 16px;
        border-top: none;
      }

      nav ul li>ul li a {
        color: #ddd;
        text-decoration: none;
      }

      nav ul li>ul li a:hover,
      nav ul li>ul li a:focus,
      nav ul li>ul li a:visited {
        color: #cef100;
        text-decoration: none;
      }

      nav ul li>ul li:hover {
        background-color: transparent;
        color: #cef100;
      }

      nav ul li>ul li:hover a {
        color: #cef100;
      }

      .menu-btn {
        display: flex;
      }

      .topbar {
        font-size: 13px;
        padding: 6px 15px;
      }

      .topbar-left div,
      .topbar-right a {
        margin-right: 10px;
        font-size: 13px;
      }

      .topbar-left div svg,
      .topbar-right a svg {
        width: 14px;
        height: 14px;
        margin-right: 4px;
      }

      main {
        padding: 25px 20px;
        font-size: 16px;
      }

      .footer-main {
        padding: 30px 15px 30px;
      }

      .footer-logo {
        flex-direction: column;
        gap: 8px;
      }

      .footer-logo img {
        height: 30px;
      }

      .footer-logo-text {
        font-size: 18px;
      }

      .footer-nav {
        flex-direction: column;
        gap: 12px;
        font-size: 14px;
      }

      .footer-contact {
        flex-direction: column;
        gap: 12px;
        font-size: 13px;
        margin-top: 20px;
      }

      .bottom-bar {
        flex-direction: column;
        gap: 6px;
        padding: 10px 15px;
        font-size: 12px;
        text-align: center;
      }
    }

    /* Cursor pointer for submenu toggles on mobile */
    nav ul li.dropdown {
      user-select: none;
    }

    /* Utility cursor pointer for footer nav dropdown */
    .footer-nav li.dropdown {
      user-select: none;
    }

    /* --- RunRoute Styles --- */
    .rungo-wrapper {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      background: linear-gradient(180deg, #f8fafc 0%, #eef2ff 100%);
      color: #0f172a;
      width: 100%;
      isolation: isolate;
    }

    .rungo-wrapper *,
    .rungo-wrapper *::before,
    .rungo-wrapper *::after {
      box-sizing: border-box;
    }

    .rungo-wrapper input,
    .rungo-wrapper button,
    .rungo-wrapper label {
      font-family: inherit;
      font-size: inherit;
      line-height: inherit;
      margin: 0;
    }

    .rungo-wrapper input[type="checkbox"] {
      margin: 0;
      cursor: pointer;
    }

    .rungo-wrapper .leaflet-container {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    .rungo-wrapper .app {
      max-width: 1160px;
      margin: 0 auto;
      padding: 16px 0;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .rungo-wrapper .panel,
    .rungo-wrapper .search-panel {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 16px;
      padding: 10px 14px;
      box-shadow: 0 18px 40px rgba(15, 23, 42, 0.12);
      border: 1px solid #e5e7eb;
      
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      backdrop-filter: saturate(180%) blur(6px);
    }

    .rungo-wrapper #strava-form-panel {
      max-width: 1160px;
      margin: 0 auto;
      display: block;
    }

    .rungo-wrapper #strava-form-panel .panel {
      display: block;
    }

    .rungo-wrapper .info-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .rungo-wrapper .info-top {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: baseline;
    }

    .rungo-wrapper .distance-label {
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #6b7280;
    }

    .rungo-wrapper .distance-value {
      font-weight: 700;
      font-size: 1.2rem;
      color: #111827;
    }

    #buttonacc {
      background: #cbd5e1 !important;
    }

    .rungo-wrapper .mode-tag {
      font-size: 0.8rem;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #cbd5e1;
      display: inline-flex;
      align-items: center;
      gap: 4px;
      background: #f9fafb;
      color: #111827;
    }

    .rungo-wrapper .options-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      font-size: 0.85rem;
      color: #374151;
    }

    .rungo-wrapper .options-row label {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      cursor: pointer;
    }

    .rungo-wrapper .actions {
      
      gap: 6px;
      margin-top: 20px;
    }

    .rungo-wrapper .export-actions {
      //justify-content: center;
      width: 100%;
    }

    .rungo-wrapper button {
      border: 1px solid transparent;
      padding: 6px 12px;
      font-size: 0.9rem;
      cursor: pointer;
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.15s ease, border-color 0.15s ease;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      background: #cef100;
      color: #111;
      font-weight: 500;
    }

    .rungo-wrapper button:hover {
      background: #b8d900;
      color: #111;
    }

    .rungo-wrapper .btn-danger,
    .rungo-wrapper button.btn-danger {
      background: #cef100;
      color: #111;
      border-color: #cef100;
    }

    .rungo-wrapper .btn-danger:hover,
    .rungo-wrapper button.btn-danger:hover {
      background: #b8d900;
      color: #111;
      border-color: #b8d900;
    }

    .rungo-wrapper .btn-outline-danger,
    .rungo-wrapper button.btn-outline-danger {
      background: transparent;
      color: #111;
      border-color: #cef100;
    }

    .rungo-wrapper .btn-outline-danger:hover,
    .rungo-wrapper button.btn-outline-danger:hover {
      background: #cef100;
      color: #111;
      border-color: #cef100;
    }

    .rungo-wrapper button:disabled {
      opacity: 0.45;
      cursor: default;
      box-shadow: none;
      transform: none;
    }

    .rungo-wrapper button:active:not(:disabled) {
      transform: translateY(1px) scale(0.99);
      box-shadow: none !important;
    }

    .rungo-wrapper .map-wrapper {
      max-width: 1160px;
      margin: 0 auto;
      border-radius: 18px;
      overflow: hidden;
      box-shadow: 0 22px 45px rgba(15, 23, 42, 0.2);
      border: 1px solid #e5e7eb;
    }

    .rungo-wrapper #map {
      width: 100%;
      height: 65vh;
      min-height: 380px;
    }

    .rungo-wrapper .hint {
      font-size: 0.85rem;
      color: #4b5563;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .rungo-wrapper .pill {
      padding: 4px 10px;
      border-radius: 999px;
      background: #e5e7eb;
    }

    .rungo-wrapper .share-output {
      margin-top: 6px;
      display: none;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .rungo-wrapper .share-output input {
      flex: 1;
      min-width: 220px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid #cbd5e1;
      font-size: 0.85rem;
      color: #111827;
    }

    .rungo-wrapper .share-output small {
      font-size: 0.8rem;
      color: #6b7280;
    }

    .rungo-wrapper .search-panel {
      justify-content: flex-start;
      gap: 10px;
    }

    .rungo-wrapper .search-label {
      font-size: 0.85rem;
      color: #4b5563;
      white-space: nowrap;
    }

    .rungo-wrapper .search-panel input {
      flex: 1;
      
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(203, 213, 225, 1);
      font-size: 0.9rem;
      color: #111827;
    }

    .rungo-wrapper .search-status {
      font-size: 0.8rem;
      color: #6b7280;
    }

    .leaflet-control-attribution {
      display: none;
    }

    @media (max-width: 640px) {

      .topbar,
      .rungo-wrapper .navbar {
        display: none !important;
      }

      #strava-form-panel {
        justify-content: right;
      }

      

      .rungo-wrapper .search-panel {
        position: sticky;
        top: 8px;
        z-index: 10;
        background: rgba(255,255,255,0.95);
        backdrop-filter: blur(4px);
      }
      .rungo-wrapper .search-inline,
      .rungo-wrapper .upload-inline {
        flex-direction: column;
        align-items: stretch;
      }
      .rungo-wrapper .search-inline button,
      .rungo-wrapper .upload-inline button {
        width: 100%;
      }

      .rungo-wrapper .search-panel input {
        width: 100%;
      }

      .rungo-wrapper .panel {
        padding: 10px;
      }

      .rungo-wrapper #map {
        height: 60vh;
      }
    }
    .strava-disabled #strava-form-panel {
      display: none !important;
    }
  </style>
  <script>
    window.ENABLE_STRAVA_EXPORT = false; //untuk setting strava
    if (window.ENABLE_STRAVA_EXPORT === false) {
      document.addEventListener('DOMContentLoaded', function(){ document.body.classList.add('strava-disabled') })
    }
  </script>
  <link rel="icon" href="https://res.cloudinary.com/dslfarxct/images/w_32,h_32,c_fill,g_auto/f_auto,q_auto/v1760832825/cropped-logo-ruang-lari-scaled-1/cropped-logo-ruang-lari-scaled-1.png?_i=AA" sizes="32x32" />
  <link rel="icon" href="https://res.cloudinary.com/dslfarxct/images/w_192,h_192,c_fill,g_auto/f_auto,q_auto/v1760832825/cropped-logo-ruang-lari-scaled-1/cropped-logo-ruang-lari-scaled-1.png?_i=AA" sizes="192x192" />
  <link rel="apple-touch-icon" href="https://res.cloudinary.com/dslfarxct/images/w_180,h_180,c_fill,g_auto/f_auto,q_auto/v1760832825/cropped-logo-ruang-lari-scaled-1/cropped-logo-ruang-lari-scaled-1.png?_i=AA" />
  <meta name="msapplication-TileImage" content="https://res.cloudinary.com/dslfarxct/images/w_270,h_270,c_fill,g_auto/f_auto,q_auto/v1760832825/cropped-logo-ruang-lari-scaled-1/cropped-logo-ruang-lari-scaled-1.png?_i=AA" />
</head>

<body>
  <!-- Top bar -->
  <div class="topbar">
    <div class="topbar-left">
      <div>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M1.5 3v18h21v-6l-5-3l5-3v-6h-21zm19 15h-17v-12h17v4.76c-1.64 1.147-3.897 2.477-6.08 2.477-2.765 0-4.792-1.035-5.92-2.477v-4.762h17v4.76z" />
        </svg>
        ruanglari@gmail.com
      </div>
      <div>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M12 2c-4.418 0-8 3.582-8 8 0 4.632 5.123 10.352 6.205 11.513c.305.37.95.37 1.256 0c1.082-1.16 6.204-6.88 6.204-11.513c0-4.418-3.582-8-8-8zm0 10.4c-1.324 0-2.4-1.076-2.4-2.4s1.076-2.4 2.4-2.4 2.4 1.076 2.4 2.4-1.076 2.4-2.4 2.4z" />
        </svg>
        Malang, Jawa Timur, Indonesia
      </div>
    </div>
    <div class="topbar-right social-icons">
      <a href="#" aria-label="Twitter">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M22.46 6c-.77.35-1.5.6-2.28.71c.82-.5 1.45-1.27 1.75-2.19c-.77.46-1.62.79-2.52.98A4.13 4.13 0 0 0 16.15 5c-2.26 0-4.1 1.85-4.1 4.1c0 .32.05.64.11.94A11.75 11.75 0 0 1 3.18 5.1a4.096 4.096 0 0 0-.55 2.06c0 1.42.72 2.67 1.81 3.4c-.67 0-1.3-.2-1.85-.5v.05c0 1.98 1.41 3.64 3.28 4.03c-.34.1-.71.17-1.08.17c-.26 0-.5-.03-.75-.07c.5 1.56 1.93 2.7 3.63 2.73a8.34 8.34 0 0 1-5.14 1.77c-.33 0-.67 0-1-.06a11.763 11.763 0 0 0 6.34 1.84c7.6 0 11.75-6.29 11.75-11.75L22.46 6z" />
        </svg>
      </a>
      <a href="#" aria-label="YouTube">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M19.8 7.79c-.15-.56-.6-1-1.16-1.15C17.4 6.4 12 6.4 12 6.4s-5.4 0-6.64.24c-.56.15-1.01.59-1.16 1.15-.28 1.05-.28 3.23-.28 3.23s0 2.19.28 3.24c.15.56.6 1 1.16 1.15C6.6 17.6 12 17.6 12 17.6s5.41 0 6.64-.24c.56-.15 1.01-.59 1.16-1.15c.28-1.05.28-3.24.28-3.24s.01-2.19-.28-3.23zM10 15.6v-7.2l6 3.6-6 3.6z" />
        </svg>
      </a>
    </div>
  </div>

  <!-- Header -->
  <header>
    <div class="header-container">
      <div class="logo">
        <img src="https://res.cloudinary.com/dslfarxct/images/c_scale,w_248,h_55/f_auto,q_auto/v1760833730/ruanglari_green/ruanglari_green.png?_i=AA" alt="Ruang Lari Logo" />
      </div>

      <nav id="mainNav">
        <ul id="menu-1-31c049d" class="uael-nav-menu">
          <li id="menu-item-4143" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-has-children parent uael-has-submenu uael-creative-menu parent-has-child dropdown">
            <div class="uael-has-submenu-container">
              <a aria-expanded="false" href="https://ruanglari.com/#event" class="uael-menu-item" aria-haspopup="true">Ruang Lari<span class="uael-menu-toggle sub-arrow uael-menu-child-0"><i class="fa"></i></span></a>
            </div>
            <ul class="sub-menu">
              <li id="menu-item-4141" class="menu-item menu-item-type-post_type menu-item-object-etn uael-creative-menu">
                <a href="https://ruanglari.com/event/latihan-track-bersama/" class="uael-sub-menu-item">Latihan Bersama</a>
              </li>
            </ul>
          </li>
          <li id="menu-item-4131" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children parent uael-has-submenu uael-creative-menu parent-has-child dropdown">
            <div class="uael-has-submenu-container">
              <a aria-expanded="false" href="https://ruanglari.com/kalender-lari-nasional/" class="uael-menu-item" aria-haspopup="true">Kalender Lari<span class="uael-menu-toggle sub-arrow uael-menu-child-0"><i class="fa"></i></span></a>
            </div>
            <ul class="sub-menu">
              <li id="menu-item-4132" class="menu-item menu-item-type-taxonomy menu-item-object-category uael-creative-menu">
                <a href="https://ruanglari.com/category/event/event-lari-surabaya/" class="uael-sub-menu-item">Event Lari Surabaya</a>
              </li>
              <li id="menu-item-4133" class="menu-item menu-item-type-taxonomy menu-item-object-category uael-creative-menu">
                <a href="https://ruanglari.com/category/event/event-lari-malang/" class="uael-sub-menu-item">Event Lari Malang</a>
              </li>
              <li id="menu-item-4134" class="menu-item menu-item-type-taxonomy menu-item-object-category uael-creative-menu">
                <a href="https://ruanglari.com/category/event/event-lari-semarang/" class="uael-sub-menu-item">Event Lari Semarang</a>
              </li>
              <li id="menu-item-4136" class="menu-item menu-item-type-taxonomy menu-item-object-category uael-creative-menu">
                <a href="https://ruanglari.com/category/event/event-lari-bandung/" class="uael-sub-menu-item">Event Lari Bandung</a>
              </li>
            </ul>
          </li>
          <li id="menu-item-4212" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children parent uael-has-submenu uael-creative-menu parent-has-child dropdown">
            <div class="uael-has-submenu-container">
              <a aria-expanded="false" href="#" class="uael-menu-item" aria-haspopup="true">Running Tools<span class="uael-menu-toggle sub-arrow uael-menu-child-0"><i class="fa"></i></span></a>
            </div>
            <ul class="sub-menu">
              <li id="menu-item-5355" class="menu-item menu-item-type-post_type menu-item-object-page uael-creative-menu">
                <a href="https://ruanglari.com/buat-rute-lari/" class="uael-sub-menu-item">Running Route</a>
              </li>
              <li id="menu-item-4140" class="menu-item menu-item-type-custom menu-item-object-custom uael-creative-menu">
                <a href="https://ruanglari.com/freeprogram/" class="uael-sub-menu-item">Running Program</a>
              </li>
              <li id="menu-item-4139" class="menu-item menu-item-type-post_type menu-item-object-page uael-creative-menu">
                <a href="https://ruanglari.com/running-calculator/" class="uael-sub-menu-item">Running Calculator</a>
              </li>
              <li id="menu-item-4138" class="menu-item menu-item-type-post_type menu-item-object-page uael-creative-menu">
                <a href="https://ruanglari.com/ruang-lari-pace-pro/" class="uael-sub-menu-item">Ruang Lari Pace Pro</a>
              </li>
            </ul>
          </li>
          <li id="menu-item-4137" class="menu-item menu-item-type-post_type menu-item-object-page parent uael-creative-menu">
            <a href="https://ruanglari.com/blog/" class="uael-menu-item">Blog</a>
          </li>
        </ul>
      </nav>

      <!-- Hamburger menu button -->
      <div class="menu-btn" id="menuBtn" aria-label="Toggle menu" role="button" tabindex="0">
        <div></div>
        <div></div>
        <div></div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main>
    <!-- Leaflet CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin="" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" />

    <div class="rungo-wrapper">
      <div class="app">
        <section class="panel">
          <div class="info-group">
            <div class="info-top">
              <div>
                <div class="distance-label">Total jarak</div>
                <div class="distance-value" id="distance-display">0.00 km</div>
              </div>
              <div>
                <div class="distance-label">Elevation gain</div>
                <div class="distance-value" id="elev-display">0 m</div>
              </div>
              <div>
                <div id="mode-tag" class="mode-tag">Mode: edit rute</div>
              </div>
            </div>
            <div class="options-row">
              <label>
                <input type="checkbox" id="follow-roads" checked />
                Ikuti jalan (snap ke jalan)
              </label>
              <label>
                <input type="checkbox" id="route-arrows-toggle" checked />
                Tampilkan arah rute
              </label>
              <span style="font-size:0.8rem;color:#6b7280;">Routing: OSRM (foot)</span>
            </div>
          </div>

          <div class="actions">
            <button class="btn btn-outline-danger btn-sm" id="reset-btn">Reset</button>
            <button class="btn btn-outline-danger btn-sm" id="undo-btn" disabled>Undo</button>
            <button class="btn btn-outline-danger btn-sm" id="redo-btn" disabled>Redo</button>
            <button class="btn btn-danger btn-sm" id="share-btn"><i class="bi bi-share"></i> Share rute lari</button>
            <button class="btn btn-outline-danger btn-sm d-none" id="strava-auth-btn">Hubungkan Strava</button>
            <button class="btn btn-outline-danger btn-sm" id="strava-disconnect-btn" style="display:none;">Putuskan Koneksi Strava</button>
            <button class="btn btn-outline-danger btn-sm" id="strava-upload-route-btn">Download GPX File</button>
            <a href="https://ruanglari.com/ruang-lari-pace-pro/" target="_blank"><button class="btn btn-outline-danger btn-sm" id="strava-upload-route-btn">Strategi Pace Pro</button></a>
            <span class="search-status" id="search-status"></span>
          </div>

          <div class="share-output" id="share-output">
            <input id="share-url" readonly />
            <small id="share-status"></small>
          </div>
        </section>

        <section class="search-panel">
          <div class="row">
            <div class="col-md-6">
              <span class="search-label">Cari lokasi:</span>
              <div class="d-flex gap-2 align-items-center search-inline">
                <input class="form-control form-control-sm" id="search-input" placeholder="Contoh: Malang, Monas, Alun-alun Jember" />
                <button class="btn btn-outline-danger btn-sm" id="search-btn">Cari</button>
                
              </div>
            </div>
            <div class="col-md-6">
              <span class="search-label">Upload GPX:</span>
              <div class="d-flex gap-2 align-items-center upload-inline" style="min-width: 200px;">
                <input class="form-control form-control-sm" type="file" id="file-upload" accept=".gpx,.tcx,.fit" />
                <button class="btn btn-outline-danger btn-sm" id="upload-file-btn">Upload GPX</button>
              </div>
              <small id="strava-status" class="d-block mt-1" style="color:#6b7280;"></small>
              <div id="export-metrics" class="d-flex flex-wrap gap-2 mt-1 small" style="color:#374151;"></div>
            </div>
          </div>
        </section>

        <section class="hint" style="display: none;">
          <span class="pill">üí° Klik di peta untuk menambah titik rute (muncul marker).</span>
          <span class="pill">üõ£ "Ikuti jalan" supaya rute ngikut jalan (jalan kaki/lari).</span>
          <span class="pill">‚Ü© Undo / Redo untuk langkah terakhir.</span>
          <span class="pill">üîç Gunakan kotak pencarian untuk lompat ke kota/lokasi tertentu.</span>
        </section>
      </div>

      <section class="panel" id="strava-form-panel" style="display: none;">
        <div class="accordion" id="stravaAccordion" style="background:transparent;">
          <div class="accordion-item" style="background:transparent;border:none;">
            <h2 class="accordion-header">
              <button class="accordion-button py-1 px-2" type="button" data-bs-toggle="collapse" data-bs-target="#cfgCollapse" aria-expanded="true" aria-controls="cfgCollapse" id="buttonacc">
                Export
              </button>
            </h2>
            <div id="cfgCollapse" class="accordion-collapse collapse show">
              <div class="accordion-body p-2">
                <div class="container-fluid" style="padding:0;">
                  <div class="row g-3">
                    <div class="col-md-4">
                      <label class="form-label small text-muted mb-1">Nama Aktivitas</label>
                      <input class="form-control form-control-sm" id="name-input" placeholder="Mis. Easy Run" />
                    </div>
                    <div class="col-md-4">
                      <label class="form-label small text-muted mb-1">Tanggal & Waktu</label>
                      <input class="form-control form-control-sm" id="start-input" type="datetime-local" />
                    </div>
                    <div class="col-md-4">
                      <label class="form-label small text-muted mb-1">Device</label>
                      <select class="form-select form-select-sm" id="device-select">
                        <option value="">Pilih device</option>
                        <option>Garmin</option>
                        <option>Coros</option>
                        <option>Polar</option>
                        <option>Suunto</option>
                        <option>Apple Watch</option>
                        <option>Android Phone</option>
                        <option>iPhone</option>
                      </select>
                    </div>
                  </div>
                  <div class="row g-3 mt-2">
                    <div class="col-md-4">
                      <label class="form-label small text-muted mb-1">Pace (menit/km)</label>
                      <input class="form-control form-control-sm" id="pace-input" placeholder="Contoh: 4:30" />
                    </div>
                    <div class="col-md-4">
                      <label class="form-label small text-muted mb-1">Heart Rate Rata-rata</label>
                      <input class="form-control form-control-sm" id="hr-input" placeholder="BPM" type="number" min="30" max="250" />
                    </div>
                    <div class="col-md-4">
                      <label class="form-label small text-muted mb-1">Cadence Rata-rata (spm)</label>
                      <input class="form-control form-control-sm" id="cadence-input" placeholder="SPM" type="number" min="120" max="230" />
                    </div>
                    <div class="col-md-4">
                      <label class="form-label small text-muted mb-1">Power Rata-rata (W)</label>
                      <input class="form-control form-control-sm" id="power-input" placeholder="Watts" type="number" min="0" max="1000" />
                    </div>
                  </div>
                  <div class="row g-3 mt-3">
                    <div class="col-md-6">
                      <div class="d-flex flex-wrap gap-2 export-actions">
                        <button class="btn btn-danger btn-sm" id="strava-btn">Export ke Strava</button>
                        
                      </div>
                    </div>

                  </div>
                </div>
              </div>
            </div>
          </div>
      </section>

      <div class="map-wrapper">
        <div id="map"></div>
      </div>
      <div style="max-width:1160px;margin:8px auto 0;background:#fff;padding:12px;border-radius:12px;box-shadow: 0 18px 40px rgba(15, 23, 42, 0.12);">
        <div id="elev-chart" style="height:220px;"></div>
      </div>

      <div class="modal fade" id="hintModal" tabindex="-1">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-body" style="font-size:0.95rem;">
              <div class="d-flex flex-column" style="gap:8px;">
                <div>üí° Klik di peta untuk menambah titik rute (muncul marker).</div>
                <div>üõ£ "Ikuti jalan" supaya rute ngikut jalan (jalan kaki/lari).</div>
                <div>‚Ü© Undo / Redo untuk langkah terakhir.</div>
                <div>üîç Gunakan kotak pencarian untuk lompat ke kota/lokasi tertentu.</div>
              </div>
            </div>
            <div class="modal-footer">
              <button class="btn btn-danger btn-sm" data-bs-dismiss="modal" style="background:#cef100;color:#111;border-color:#cef100;">Tutup</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer Main -->
  <div class="footer-main">
    <div class="footer-logo">
      <img src="https://res.cloudinary.com/dslfarxct/images/c_scale,w_248,h_55/f_auto,q_auto/v1760833730/ruanglari_green/ruanglari_green.png?_i=AA" alt="Ruang Lari Footer Logo" />

    </div>
    <ul class="footer-nav">
      <li class="dropdown">Ruang Lari
        <ul>
          <li><a href="#">Tentang</a></li>
          <li><a href="#">FAQ</a></li>
          <li><a href="#">Testimoni</a></li>
        </ul>
      </li>
      <li class="dropdown">Kalender Lari
        <ul>
          <li><a href="#">Event</a></li>
          <li><a href="#">Pendaftaran</a></li>
          <li><a href="#">Hasil</a></li>
        </ul>
      </li>
      <li class="dropdown">Running Tools
        <ul>
          <li><a href="#">Log Latihan</a></li>
          <li><a href="#">Pacer</a></li>
          <li><a href="#">Calculator</a></li>
        </ul>
      </li>
      <li><a href="/blog">Blog</a></li>
    </ul>
    <div class="footer-contact">
      <div>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M1.5 3v18h21v-6l-5-3l5-3v-6h-21zm19 15h-17v-12h17v4.76c-1.64 1.147-3.897 2.477-6.08 2.477-2.765 0-4.792-1.035-5.92-2.477v-4.762h17v4.76z" />
        </svg>
        ruanglari@gmail.com
      </div>
      <div>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M12 2c-4.418 0-8 3.582-8 8 0 4.632 5.123 10.352 6.205 11.513c.305.37.95.37 1.256 0c1.082-1.16 6.204-6.88 6.204-11.513c0-4.418-3.582-8-8-8zm0 10.4c-1.324 0-2.4-1.076-2.4-2.4s1.076-2.4 2.4-2.4 2.4 1.076 2.4 2.4-1.076 2.4-2.4 2.4z" />
        </svg>
        Malang, Jawa Timur, Indonesia
      </div>
    </div>
  </div>

  <!-- Bottom Bar -->
  <div class="bottom-bar">
    <div>All about running, Event, Calendar, Pacer, Coaching, Running Tools</div>
    <div>Copyright ¬© 2025. All rights reserved.</div>
  </div>

  <script>
    // Toggle mobile menu open/close
    const menuBtn = document.getElementById('menuBtn');
    const mainNav = document.getElementById('mainNav');

    menuBtn.addEventListener('click', () => {
      mainNav.classList.toggle('open');
      menuBtn.classList.toggle('active');
    });
    menuBtn.addEventListener('keydown', (e) => {
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault();
        mainNav.classList.toggle('open');
        menuBtn.classList.toggle('active');
      }
    });

    // Mobile Dropdown toggles
    const dropdownParents = mainNav.querySelectorAll('li.dropdown');
    dropdownParents.forEach(parent => {
      parent.addEventListener('click', (e) => {
        // Prevent link clicks inside dropdown (if any)
        if (e.target.tagName === 'A') return;
        e.preventDefault();
        parent.classList.toggle('expanded');
      });
    });

    // Footer dropdown on mobile with same approach
    const footerDropdowns = document.querySelectorAll('.footer-nav li.dropdown');
    footerDropdowns.forEach(parent => {
      parent.addEventListener('click', (e) => {
        if (e.target.tagName === 'A') return;
        e.preventDefault();
        parent.classList.toggle('expanded');
      });
    });

    // Close mobile menu when clicking outside
    document.addEventListener('click', (e) => {
      const nav = document.getElementById('mainNav');
      const menuBtn = document.getElementById('menuBtn');
      if (nav && nav.classList.contains('open') && !nav.contains(e.target) && !menuBtn.contains(e.target)) {
        nav.classList.remove('open');
        menuBtn.classList.remove('active');
      }
    });
  </script>

  <!-- Leaflet JS -->
  <script
    src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
    crossorigin=""></script>

  <script src="https://unpkg.com/leaflet-polylinedecorator@1.7.0/dist/leaflet.polylineDecorator.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="rungo.js"></script>
  <script>
    // ====== CATATAN ======
    // Semua inisialisasi map dan fungsi terkait sudah dihandle oleh rungo.js
    // Script ini untuk fungsi tambahan dan override beberapa fungsi

    (function() {
      // Tunggu sampai rungo.js selesai inisialisasi
      function initCustomFeatures() {
        const stravaAuthBtn = document.getElementById("strava-auth-btn");
        const stravaFormPanel = document.getElementById("strava-form-panel");

        // 1. Cek apakah sudah terhubung ke Strava (dari callback URL)
        const urlParams = new URLSearchParams(window.location.search);
        const stravaCallback = urlParams.get('rungo_strava_callback') || window.location.pathname.includes('strava/callback');
        const stravaConnected = localStorage.getItem('rungo_strava_connected') === 'true' || stravaCallback;
        
        if (stravaConnected) {
          // Tampilkan form panel dan hide button
          if (stravaFormPanel) {
            stravaFormPanel.style.display = "block";
          }
          if (stravaAuthBtn) {
            stravaAuthBtn.style.display = "none";
            stravaFormPanel.style.display = "block";
          }
          // Set flag di localStorage
          localStorage.setItem('rungo_strava_connected', 'true');
        }

        // 2. Load rute dari localStorage jika ada (setelah kembali dari callback)
        const savedRoute = localStorage.getItem('rungo_saved_route');
        if (savedRoute && stravaCallback) {
          try {
            const points = JSON.parse(savedRoute);
            // Trigger load route - kita perlu akses ke instance rungo.js
            // Karena rungo.js sudah handle loadRouteFromUrl, kita bisa set URL param
            if (points && points.length >= 2) {
              const json = JSON.stringify(points);
              const encoded = encodeURIComponent(btoa(json));

              // Cek apakah route sudah ada di URL
              const currentRoute = urlParams.get('route');
              if (currentRoute !== encoded) {
                // Route belum ada atau berbeda, set URL param
                const newUrl = window.location.origin + window.location.pathname + '?route=' + encoded;
                window.history.replaceState({}, '', newUrl);
                // Reload untuk trigger loadRouteFromUrl di rungo.js
                window.location.reload();
              } else {
                // Route sudah ada, tidak perlu reload
                // Tapi pastikan marker start/finish ditambahkan
                setTimeout(() => {
                  addStartFinishMarkers(points);
                }, 500);
              }
            }
          } catch (e) {
            console.error("Error loading saved route:", e);
          }
        }

        // 3. Override fungsi share untuk menambahkan marker start dan finish
        const shareBtn = document.getElementById("share-btn");
        if (shareBtn) {
          // Intercept share button click
          shareBtn.addEventListener("click", async function(e) {
            // Biarkan rungo.js handle share terlebih dahulu
            // Kemudian tambahkan marker setelah URL dibuat
            setTimeout(() => {
              // Cek share URL input untuk mendapatkan route
              const shareUrlInput = document.getElementById("share-url");
              if (shareUrlInput && shareUrlInput.value) {
                try {
                  const url = new URL(shareUrlInput.value);
                  const routeParam = url.searchParams.get('route');
                  if (routeParam) {
                    const json = atob(decodeURIComponent(routeParam));
                    const points = JSON.parse(json);
                    if (points && points.length >= 2) {
                      addStartFinishMarkers(points);
                      // Simpan ke localStorage juga
                      localStorage.setItem('rungo_saved_route', JSON.stringify(points));
                    }
                  }
                } catch (e) {
                  console.error("Error parsing share URL:", e);
                }
              }

              // Juga cek dari URL current
              const shareUrlParams = new URLSearchParams(window.location.search);
              const encoded = shareUrlParams.get('route');
              if (encoded) {
                try {
                  const json = atob(decodeURIComponent(encoded));
                  const points = JSON.parse(json);
                  if (points && points.length >= 2) {
                    addStartFinishMarkers(points);
                    // Simpan ke localStorage
                    localStorage.setItem('rungo_saved_route', JSON.stringify(points));
                  }
                } catch (e) {
                  console.error("Error parsing route from URL:", e);
                }
              }
            }, 300);
          }, true); // Use capture untuk menjalankan sebelum rungo.js

          // Monitor share URL input untuk auto-save
          const shareUrlInput = document.getElementById("share-url");
          if (shareUrlInput) {
            const observer = new MutationObserver(function(mutations) {
              mutations.forEach(function(mutation) {
                if (mutation.type === 'attributes' && mutation.attributeName === 'value') {
                  const value = shareUrlInput.value;
                  if (value) {
                    try {
                      const url = new URL(value);
                      const routeParam = url.searchParams.get('route');
                      if (routeParam) {
                        const json = atob(decodeURIComponent(routeParam));
                        const points = JSON.parse(json);
                        if (points && points.length >= 2) {
                          localStorage.setItem('rungo_saved_route', JSON.stringify(points));
                          addStartFinishMarkers(points);
                        }
                      }
                    } catch (e) {
                      // Ignore
                    }
                  }
                }
              });
            });
            observer.observe(shareUrlInput, {
              attributes: true,
              attributeFilter: ['value']
            });
          }
        }

        // Fungsi untuk extract points dari polyline SVG (jika rute belum di-share)
        function extractPointsFromPolyline() {
          try {
            const mapElement = document.getElementById("map");
            if (!mapElement) return null;

            // Cari polyline SVG
            const polyline = mapElement.querySelector('svg path.leaflet-interactive');
            if (!polyline) return null;

            const pathData = polyline.getAttribute('d');
            if (!pathData) return null;

            // Parse SVG path untuk mendapatkan koordinat
            // Format: M lat,lng L lat,lng L lat,lng ...
            const coords = [];
            const commands = pathData.match(/[ML][\d\.\-\s,]+/g);
            if (commands) {
              commands.forEach(cmd => {
                const values = cmd.substring(1).trim().split(/[\s,]+/).map(parseFloat);
                if (values.length >= 2 && !isNaN(values[0]) && !isNaN(values[1])) {
                  // Convert pixel coordinates to lat/lng
                  // Ini kompleks, lebih baik kita simpan saat user klik atau share
                  // Skip untuk sekarang
                }
              });
            }

            return null; // Return null karena konversi pixel ke lat/lng kompleks
          } catch (e) {
            return null;
          }
        }

        // 4. Simpan rute ke localStorage saat klik hubungkan Strava
        if (stravaAuthBtn) {
          stravaAuthBtn.addEventListener("click", function(e) {
            // Simpan rute ke localStorage sebelum redirect
            const authUrlParams = new URLSearchParams(window.location.search);
            const encoded = authUrlParams.get('route');

            if (encoded) {
              // Route sudah ada di URL, simpan
              try {
                const json = atob(decodeURIComponent(encoded));
                const points = JSON.parse(json);
                localStorage.setItem('rungo_saved_route', JSON.stringify(points));
              } catch (e) {
                console.error("Error saving route:", e);
              }
            } else {
              // Coba ambil dari localStorage yang sudah disimpan secara berkala
              let savedRoute = localStorage.getItem('rungo_saved_route');

              // Jika belum ada, coba ambil dari share URL input (jika user sudah klik share)
              if (!savedRoute) {
                const shareUrlInput = document.getElementById("share-url");
                if (shareUrlInput && shareUrlInput.value) {
                  try {
                    const url = new URL(shareUrlInput.value);
                    const routeParam = url.searchParams.get('route');
                    if (routeParam) {
                      const json = atob(decodeURIComponent(routeParam));
                      const points = JSON.parse(json);
                      localStorage.setItem('rungo_saved_route', JSON.stringify(points));
                      savedRoute = JSON.stringify(points);
                    }
                  } catch (e) {
                    console.error("Error saving route from share URL:", e);
                  }
                }
              }

              // Jika masih belum ada, simpan flag untuk nanti
              if (!savedRoute) {
                localStorage.setItem('rungo_saving_route', 'true');
                // Trigger share button untuk membuat URL (jika user belum share)
                // Tapi jangan tampilkan share output, hanya simpan ke localStorage
                const shareBtn = document.getElementById("share-btn");
                if (shareBtn && !document.getElementById("share-url").value) {
                  // User belum share, kita perlu trigger share untuk mendapatkan URL
                  // Tapi ini akan menampilkan share output, jadi skip untuk sekarang
                  // Rute akan tersimpan saat user klik share nanti
                }
              }
            }

            // Toggle form panel
            if (stravaFormPanel) {
              if (stravaFormPanel.style.display === "none" || !stravaFormPanel.style.display) {
                stravaFormPanel.style.display = "block";
                stravaFormPanel.scrollIntoView({
                  behavior: "smooth",
                  block: "nearest"
                });
              } else {
                stravaFormPanel.style.display = "none";
              }
            }
          }, true);
        }

        // Simpan rute ke localStorage secara berkala saat user membuat rute
        // Monitor share URL input dan URL parameter untuk mendapatkan points
        let lastSavedRoute = null;
        const routeSaver = setInterval(() => {
          // Cek apakah ada route di URL
          const checkUrlParams = new URLSearchParams(window.location.search);
          const encoded = checkUrlParams.get('route');

          if (encoded && encoded !== lastSavedRoute) {
            try {
              const json = atob(decodeURIComponent(encoded));
              const points = JSON.parse(json);
              if (points && points.length >= 2) {
                localStorage.setItem('rungo_saved_route', JSON.stringify(points));
                lastSavedRoute = encoded;
              }
            } catch (e) {
              // Ignore error
            }
          }

          // Juga cek dari share URL input jika ada (setelah user klik share)
          const shareUrlInput = document.getElementById("share-url");
          if (shareUrlInput && shareUrlInput.value) {
            try {
              const url = new URL(shareUrlInput.value);
              const routeParam = url.searchParams.get('route');
              if (routeParam && routeParam !== lastSavedRoute) {
                const json = atob(decodeURIComponent(routeParam));
                const points = JSON.parse(json);
                if (points && points.length >= 2) {
                  localStorage.setItem('rungo_saved_route', JSON.stringify(points));
                  lastSavedRoute = routeParam;
                }
              }
            } catch (e) {
              // Ignore error jika URL tidak valid
            }
          }
        }, 1000); // Simpan setiap 1 detik

        // Fungsi untuk mendapatkan map instance
        function getMapInstance() {
          if (window.rungoMapInstance) {
            return window.rungoMapInstance;
          }

          const mapElement = document.getElementById("map");
          if (!mapElement || !mapElement._leaflet_id) {
            return null;
          }

          // Coba dapatkan dari marker atau polyline yang ada
          const existingLayer = mapElement.querySelector('.leaflet-marker-icon, .leaflet-interactive');
          if (existingLayer && existingLayer._leaflet_id) {
            try {
              const layerId = existingLayer._leaflet_id;
              // Leaflet menyimpan layer instances
              if (window.L && window.L.stamp) {
                // Coba akses via Leaflet internal
                // Leaflet menyimpan map di element
                const map = mapElement._leaflet;
                if (map) {
                  window.rungoMapInstance = map;
                  return map;
                }
              }
            } catch (e) {
              // Ignore
            }
          }

          return null;
        }

        // Fungsi untuk menambahkan marker start dan finish
        function addStartFinishMarkers(points) {
          if (!window.L || !points || points.length < 2) return;

          try {
            const mapElement = document.getElementById("map");
            if (!mapElement || !mapElement._leaflet_id) {
              // Map belum ready, coba lagi nanti
              setTimeout(() => addStartFinishMarkers(points), 500);
              return;
            }

            // Hapus marker start/finish yang sudah ada
            if (window.startMarker) {
              try {
                window.startMarker.remove();
              } catch (e) {}
              window.startMarker = null;
            }
            if (window.finishMarker) {
              try {
                window.finishMarker.remove();
              } catch (e) {}
              window.finishMarker = null;
            }

            const first = points[0];
            const last = points[points.length - 1];

            // Marker start (hijau)
            const startIcon = window.L.divIcon({
              className: 'rungo-marker rungo-start-marker',
              html: '<i class="bi bi-flag-fill" style="font-size:24px;color:#16a34a;"></i>',
              iconSize: [24, 24],
              iconAnchor: [12, 24]
            });

            // Marker finish (merah)
            const finishIcon = window.L.divIcon({
              className: 'rungo-marker rungo-finish-marker',
              html: '<i class="bi bi-flag-fill" style="font-size:24px;color:#dc2626;"></i>',
              iconSize: [24, 24],
              iconAnchor: [12, 24]
            });

            // Dapatkan map instance
            let map = getMapInstance();

            // Jika belum dapat, coba lagi nanti
            if (!map) {
              setTimeout(() => addStartFinishMarkers(points), 500);
              return;
            }

            // Tambahkan marker
            window.startMarker = window.L.marker([first[0], first[1]], {
              icon: startIcon
            }).addTo(map);
            window.finishMarker = window.L.marker([last[0], last[1]], {
              icon: finishIcon
            }).addTo(map);
            window.rungoMapInstance = map;
          } catch (e) {
            console.error("Error adding start/finish markers:", e);
            // Coba lagi setelah delay
            setTimeout(() => addStartFinishMarkers(points), 1000);
          }
        }

        // Simpan map instance saat pertama kali diakses (via event click)
        document.addEventListener('click', function(e) {
          if (e.target.closest('#map')) {
            const mapElement = document.getElementById("map");
            if (mapElement && mapElement._leaflet_id && !window.rungoMapInstance) {
              try {
                const map = getMapInstance();
                if (map) {
                  window.rungoMapInstance = map;
                }
              } catch (e) {
                // Ignore
              }
            }
          }
        }, true);

        // Override addClickMarker untuk menggunakan marker lokasi standar
        // Karena rungo.js menggunakan closure, kita perlu intercept saat marker dibuat
        // Kita akan menambahkan observer untuk marker baru

        // Monitor untuk marker baru yang ditambahkan
        const mapElement = document.getElementById("map");
        if (mapElement) {
          const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
              mutation.addedNodes.forEach(function(node) {
                if (node.nodeType === 1) {
                  // Cek apakah ini marker dari rungo.js
                  const marker = node.querySelector('.rungo-marker');
                  if (marker && marker.classList.contains('rungo-marker')) {
                    // Marker sudah dibuat oleh rungo.js dengan icon yang benar
                    // Tidak perlu diubah karena rungo.js sudah menggunakan L.marker dengan divIcon
                  }
                }
              });
            });
          });

          observer.observe(mapElement, {
            childList: true,
            subtree: true
          });
        }


        // 6. Tambahkan marker start/finish saat load route dari URL
        const loadUrlParams = new URLSearchParams(window.location.search);
        const encoded = loadUrlParams.get('route');
        if (encoded) {
          setTimeout(() => {
            try {
              const json = atob(decodeURIComponent(encoded));
              const points = JSON.parse(json);
              if (points && points.length >= 2) {
                addStartFinishMarkers(points);
              }
            } catch (e) {
              console.error("Error adding markers on load:", e);
            }
          }, 500);
        }
      }

      // Coba init setelah DOM ready dan rungo.js load
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', function() {
          setTimeout(initCustomFeatures, 200);
        });
      } else {
        setTimeout(initCustomFeatures, 200);
      }
    })();
  </script>

</body>

</html>
