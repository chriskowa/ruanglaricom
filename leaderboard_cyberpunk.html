<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEON RUNNER | RuangLari Protocol</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cyber: {
                            black: '#050505',
                            dark: '#0a0a0a',
                            panel: '#111111',
                            green: '#39ff14', // Neon Green
                            cyan: '#00f3ff',  // Neon Blue/Cyan
                            dim: '#333333'
                        }
                    },
                    fontFamily: {
                        'orbitron': ['"Orbitron"', 'sans-serif'],
                        'mono': ['"Share Tech Mono"', 'monospace'],
                    },
                    boxShadow: {
                        'neon-green': '0 0 5px #39ff14, 0 0 10px #39ff14',
                        'neon-cyan': '0 0 5px #00f3ff, 0 0 10px #00f3ff',
                    },
                    animation: {
                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'scanline': 'scanline 8s linear infinite',
                    },
                    keyframes: {
                        scanline: {
                            '0%': { transform: 'translateY(-100%)' },
                            '100%': { transform: 'translateY(100%)' }
                        }
                    }
                }
            }
        }
    </script>
    
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <style>
        body { 
            background-color: #050505; 
            color: #e0e0e0;
            font-family: 'Share Tech Mono', monospace;
            background-image: 
                linear-gradient(rgba(0, 255, 65, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0, 255, 65, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: #111; }
        ::-webkit-scrollbar-thumb { background: #333; border: 1px solid #39ff14; }
        ::-webkit-scrollbar-thumb:hover { background: #39ff14; }

        .clip-corner {
            clip-path: polygon(
                0 0, 
                100% 0, 
                100% calc(100% - 15px), 
                calc(100% - 15px) 100%, 
                0 100%
            );
        }
    </style>
</head>
<body>

<div id="app" class="min-h-screen py-8 px-2 sm:px-6 relative overflow-hidden">
    
    <div class="fixed inset-0 pointer-events-none z-0 opacity-10 bg-gradient-to-b from-transparent via-cyber-green to-transparent h-screen w-full animate-scanline"></div>

    <div class="relative z-10 max-w-6xl mx-auto mb-10 text-center uppercase">
        <div class="inline-block border border-cyber-green text-cyber-green px-4 py-1 text-xs tracking-[0.2em] mb-4 shadow-neon-green bg-black">
            System Status: Online
        </div>
        <h1 class="text-4xl md:text-6xl font-black font-orbitron tracking-tighter text-white mb-2" style="text-shadow: 0 0 20px rgba(57, 255, 20, 0.5);">
            RUANGLARI <span class="text-cyber-green">PROTOCOL_40</span>
        </h1>
        <p class="text-cyber-cyan text-sm tracking-widest font-mono opacity-80">
            >> INITIATE SEQUENCE: 40 DAYS ENDURANCE TEST <<
        </p>
    </div>

    <div class="relative z-10 max-w-6xl mx-auto">
        
        <div class="flex flex-col sm:flex-row justify-center gap-4 mb-8">
            <button 
                @click="activeTab = 'discipline'"
                :class="activeTab === 'discipline' ? 'bg-cyber-green text-black shadow-neon-green border-cyber-green' : 'bg-transparent text-gray-500 border-gray-700 hover:text-cyber-green hover:border-cyber-green'"
                class="px-8 py-3 border-2 font-orbitron font-bold tracking-wider transition-all duration-300 transform skew-x-[-10deg] uppercase">
                <span class="block transform skew-x-[10deg]">1. Consistency Data</span>
            </button>
            <button 
                @click="activeTab = 'performance'"
                :class="activeTab === 'performance' ? 'bg-cyber-cyan text-black shadow-neon-cyan border-cyber-cyan' : 'bg-transparent text-gray-500 border-gray-700 hover:text-cyber-cyan hover:border-cyber-cyan'"
                class="px-8 py-3 border-2 font-orbitron font-bold tracking-wider transition-all duration-300 transform skew-x-[-10deg] uppercase">
                <span class="block transform skew-x-[10deg]">2. Final Showdown</span>
            </button>
        </div>

        <div class="bg-cyber-panel border border-gray-800 relative clip-corner">
            <div class="absolute top-0 left-0 w-2 h-2 bg-cyber-green"></div>
            <div class="absolute top-0 right-0 w-2 h-2 bg-cyber-green"></div>
            <div class="absolute bottom-0 left-0 w-2 h-2 bg-cyber-green"></div>
            
            <div class="p-4 border-b border-gray-800 flex flex-col sm:flex-row justify-between items-center gap-4 bg-black/40">
                <div class="flex items-center gap-2 text-xs text-cyber-green">
                    <span class="animate-pulse-fast">‚óè</span> 
                    SYNC: {{ lastUpdated }}
                </div>
                
                <div class="flex gap-2 w-full sm:w-auto">
                    <select v-model="filterGender" class="bg-black border border-cyber-green text-cyber-green text-sm p-2 w-full focus:outline-none focus:shadow-neon-green font-mono uppercase">
                        <option value="all">>> ALL UNITS</option>
                        <option value="M">>> MALE CLASS</option>
                        <option value="F">>> FEMALE CLASS</option>
                    </select>
                    <button @click="fetchData" class="bg-black border border-cyber-green text-cyber-green p-2 hover:bg-cyber-green hover:text-black transition-colors">
                        [REFRESH]
                    </button>
                </div>
            </div>

            <div class="relative min-h-[400px]">
                
                <div v-if="loading" class="absolute inset-0 flex flex-col items-center justify-center bg-black/90 z-20">
                    <div class="text-4xl font-orbitron text-cyber-green animate-pulse">LOADING...</div>
                    <div class="text-xs text-cyber-cyan mt-2">DECRYPTING STRAVA PACKETS</div>
                </div>

                <transition name="fade">
                    <div v-if="activeTab === 'discipline'" class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr class="text-cyber-dim border-b border-gray-800 font-orbitron text-sm">
                                    <th class="p-4 text-center w-20">RK</th>
                                    <th class="p-4">OPERATIVE</th>
                                    <th class="p-4 w-5/12">SYNC PROGRESS</th>
                                    <th class="p-4 text-center">RATE</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-800 font-mono">
                <tr v-for="(runner, index) in filteredDiscipline" :key="runner.id" class="hover:bg-white/5 transition-colors group">
                                    <td class="p-4 text-center font-bold text-xl font-orbitron">
                                        <span v-if="index === 0" class="text-yellow-400 drop-shadow-[0_0_5px_rgba(250,204,21,0.8)]">1</span>
                                        <span v-else-if="index === 1" class="text-gray-300">2</span>
                                        <span v-else-if="index === 2" class="text-orange-600">3</span>
                                        <span v-else class="text-gray-600">0{{ index + 1 }}</span>
                                    </td>
                                    <td class="p-4">
                                        <div class="flex items-center gap-4">
                                            <div class="relative">
                                                <img :src="getAvatarUrl(runner.avatar)" class="w-10 h-10 grayscale group-hover:grayscale-0 transition-all border border-cyber-green p-0.5">
                                            </div>
                                            <div>
                                                <div class="font-bold text-white group-hover:text-cyber-green tracking-wide uppercase">{{ runner.name }}</div>
                                                <div v-if="runner.qualified" class="text-[10px] text-cyber-green border border-cyber-green px-1 inline-block mt-1">
                                                    QUALIFIED
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="p-4">
                                        <div class="flex justify-between text-[10px] mb-1 text-cyber-cyan">
                                            <span>STREAK: {{ runner.streak }}</span>
                                            <span>TARGET: 40</span>
                                        </div>
                                        <div class="w-full bg-gray-900 border border-gray-700 h-2 relative">
                                            <div class="h-full bg-cyber-green shadow-neon-green relative transition-all duration-1000" 
                                                 :style="{ width: runner.percentage + '%' }">
                                            </div>
                                        </div>
                                        <div class="text-right text-[10px] text-gray-500 mt-1">{{ runner.active_days }}/40 COMPLETED</div>
                                    </td>
                                    <td class="p-4 text-center font-bold text-cyber-green text-lg font-orbitron">
                                        {{ runner.percentage }}<span class="text-xs text-gray-500">%</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </transition>

                <transition name="fade">
                    <div v-if="activeTab === 'performance'" class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr class="text-cyber-dim border-b border-gray-800 font-orbitron text-sm">
                                    <th class="p-4 text-center w-20">RK</th>
                                    <th class="p-4">OPERATIVE</th>
                                    <th class="p-4 text-center hidden sm:table-cell">BASELINE</th>
                                    <th class="p-4 text-center">FINAL</th>
                                    <th class="p-4 text-right">DELTA (GAP)</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-800 font-mono">
                                <tr v-for="(runner, index) in filteredPerformance" :key="runner.id" class="hover:bg-white/5 transition-colors group">
                                    <td class="p-4 text-center font-bold text-xl font-orbitron text-cyber-cyan">
                                        0{{ index + 1 }}
                                    </td>
                                    <td class="p-4">
                                        <div class="flex items-center gap-4">
                                            <img :src="getAvatarUrl(runner.avatar)" class="w-10 h-10 grayscale group-hover:grayscale-0 border border-cyber-cyan p-0.5">
                                            <div>
                                                <div class="font-bold text-white group-hover:text-cyber-cyan uppercase">{{ runner.name }}</div>
                                                <div class="text-[10px] text-gray-500">PACE: {{ runner.pace }}/KM</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="p-4 text-center text-gray-600 hidden sm:table-cell line-through decoration-red-500">
                                        {{ runner.old_pb }}
                                    </td>
                                    <td class="p-4 text-center">
                                        <span class="font-orbitron text-xl text-white border-b-2 border-cyber-cyan pb-1">
                                            {{ runner.new_pb }}
                                        </span>
                                    </td>
                                    <td class="p-4 text-right">
                                        <div class="inline-block bg-cyber-green/10 border border-cyber-green text-cyber-green px-3 py-1 font-bold shadow-neon-green">
                                            {{ runner.gap }}
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </transition>
                
                <div v-if="(activeTab === 'discipline' && filteredDiscipline.length === 0) || (activeTab === 'performance' && filteredPerformance.length === 0)" class="text-center py-20 border border-dashed border-gray-800 m-4">
                    <p class="text-gray-600 font-orbitron">NO DATA FOUND IN SECTOR.</p>
                </div>

            </div>
        </div>
        
        <div class="mt-4 flex justify-between items-center text-[10px] text-gray-600 uppercase font-mono border-t border-gray-900 pt-4">
            <div>SECURE CONNECTION ESTABLISHED</div>
            <div>POWERED BY <span class="text-cyber-green">STRAVA API</span> // RLAN-40</div>
        </div>
    </div>
</div>

<script>
    const { createApp } = Vue

    createApp({
        data() {
            return {
                activeTab: 'discipline',
                loading: true,
                filterGender: 'all',
                lastUpdated: 'OFFLINE',
                
                // MOCK DATA (Structure same as before)
                rawData: {
                    discipline: [],
                    performance: []
                }
            }
        },
        computed: {
            filteredDiscipline() {
                let data = this.rawData.discipline;
                if (this.filterGender !== 'all') {
                    data = data.filter(r => r.gender === this.filterGender);
                }
                return data.sort((a, b) => b.percentage - a.percentage);
            },
            filteredPerformance() {
                let data = this.rawData.performance;
                if (this.filterGender !== 'all') {
                    data = data.filter(r => r.gender === this.filterGender);
                }
                return data.sort((a, b) => b.gap_seconds - a.gap_seconds);
            }
        },
        mounted() {
            this.fetchData();
        },
        methods: {
            getAvatarUrl(path) {
                if (!path) return '/images/profile/17.jpg';
                if (path.indexOf('http') === 0) return path;
                const baseUrl = window.location.origin;
                const storageBase = baseUrl + '/storage';
                if (path.indexOf('storage/') === 0 || path.indexOf('/storage/') === 0) {
                    const cleanPath = path.indexOf('/') === 0 ? path.substring(1) : path;
                    return baseUrl + '/' + cleanPath;
                }
                const cleanPath = path.indexOf('/') === 0 ? path.substring(1) : path;
                return storageBase + '/' + cleanPath;
            },
            async fetchData() {
                this.loading = true;
                
                // SIMULATION (Replace with fetch('/api/leaderboard'))
                setTimeout(() => {
                    this.lastUpdated = new Date().toLocaleTimeString('en-US', { hour12: false }) + " UTC+7";

                    // --- MOCK DATA ---
                    this.rawData.discipline = [
                        { id: 1, name: 'Budi Runner', avatar: 'https://ui-avatars.com/api/?name=Budi+Run&background=39ff14&color=000', gender: 'M', active_days: 38, percentage: 95, streak: 12, qualified: true },
                        { id: 2, name: 'Siti Cyborg', avatar: 'https://ui-avatars.com/api/?name=Siti+Cyborg&background=00f3ff&color=000', gender: 'F', active_days: 36, percentage: 90, streak: 5, qualified: true },
                        { id: 3, name: 'Joko Speed', avatar: 'https://ui-avatars.com/api/?name=Joko+S&background=333&color=fff', gender: 'M', active_days: 20, percentage: 50, streak: 0, qualified: false },
                        { id: 4, name: 'Diana Flash', avatar: 'https://ui-avatars.com/api/?name=Diana+F&background=39ff14&color=000', gender: 'F', active_days: 40, percentage: 100, streak: 40, qualified: true },
                        { id: 5, name: 'Agus Slow', avatar: 'https://ui-avatars.com/api/?name=Agus+S&background=333&color=fff', gender: 'M', active_days: 10, percentage: 25, streak: 1, qualified: false },
                    ];

                    this.rawData.performance = [
                        { id: 1, name: 'Budi Runner', avatar: 'https://ui-avatars.com/api/?name=Budi+Run&background=39ff14&color=000', gender: 'M', old_pb: '25:00', new_pb: '23:30', gap: '-1m 30s', gap_seconds: 90, pace: '4:42' },
                        { id: 4, name: 'Diana Flash', avatar: 'https://ui-avatars.com/api/?name=Diana+F&background=39ff14&color=000', gender: 'F', old_pb: '28:10', new_pb: '27:00', gap: '-1m 10s', gap_seconds: 70, pace: '5:24' },
                        { id: 2, name: 'Siti Cyborg', avatar: 'https://ui-avatars.com/api/?name=Siti+Cyborg&background=00f3ff&color=000', gender: 'F', old_pb: '30:00', new_pb: '29:45', gap: '-15s', gap_seconds: 15, pace: '5:57' },
                    ];
                    // --- END MOCK DATA ---

                    this.loading = false;
                }, 1000);
            }
        }
    }).mount('#app')
</script>

</body>
</html>
